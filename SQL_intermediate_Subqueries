--Subqueries 

SELECT *
FROM employee_demographics

SELECT *
FROM employee_salary

----subqueries in the where clause----
--We only want to select the employee who works in the parks and rec department 
--We could do this wiht a join, salary table has dep_id and 1 is parks and rec, but we will use a subquerie 

SELECT *
FROM employee_demographics
WHERE employee_id IN (
    SELECT employee_id
    FROM employee_salary
    WHERE dept_id = 1
)

----subqueries in a select statement----
--We want to look all the salary but in other column we also want avg salary for everyone

SELECT *
FROM employee_salary

SELECT first_name, salary, AVG(salary)
FROM employee_salary
GROUP BY first_name, salary


SELECT first_name, salary,
(SELECT AVG(salary)
FROM employee_salary)
FROM employee_salary

----subqueries in the from statement ----
-- we want to gruop by gender and add some aggregate functions 
-- now we want avg of the oldest age, smallest ages and same for the count ages 

SELECT *
FROM employee_demographics

SELECT gender, AVG(age), MAX(age), MIN(age), COUNT(age)
FROM employee_demographics
group by gender 

SELECT AVG(max_age)
FROM 
(SELECT gender, 
AVG(age) as avg_age, 
MAX(age) as max_age,
MIN(age) as min_age,
COUNT(age) as count_age
FROM employee_demographics
group by gender) AS agg_table
